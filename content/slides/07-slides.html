<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Mapping data to graphics and amounts</title>
    <meta charset="utf-8" />
    <meta name="author" content="Todd Gerarden" />
    <script src="libs/header-attrs-2.19/header-attrs.js"></script>
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="css/tdg-slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








class: center middle main-title section-title-4

# Mapping data to graphics and amounts

.class-info[

**Week 7**

AEM 2850 / 5850 : R for Business Analytics&lt;br&gt;
Cornell Dyson&lt;br&gt;
Spring 2023

Acknowledgements: 
[Andrew Heiss](https://datavizm20.classes.andrewheiss.com), 
[Claus Wilke](https://wilkelab.org/SDS375/),
&lt;!-- [Grant McDermott](https://github.com/uo-ec607/lectures), --&gt;
&lt;!-- [Jenny Bryan](https://stat545.com/join-cheatsheet.html), --&gt;
[Allison Horst](https://github.com/allisonhorst/stats-illustrations)

]

---

# Announcements

Today marks the start of the data visualization component of this course

We will provide details on the group project in the next 1-2 weeks

I will discuss prelim 1 at the end of class today

Questions before we get started?


---

# Plan for Tuesday

[Course progress](#progress)

[Prologue](#prologue)

[Data, aesthetics, &amp; the grammar of graphics](#grammar-of-graphics)

[Grammatical layers](#grammatical-layers)

[Tidy data revisited](#tidy-data)

[Example (time permitting)](#example-1)

&lt;!-- [Plan for Thursday](#amounts-overview) --&gt;


---
class: inverse, center, middle
name: progress

# Course progress

---

# Course objectives reminder

1. Develop basic proficiency in `R` programming
2. Understand data structures and manipulation
3. Describe effective techniques for data visualization and communication
4. Construct effective data visualizations
5. Utilize course concepts and tools for business applications

---

# Where we've been

1. **Develop basic proficiency in `R` programming**
2. **Understand data structures and manipulation**
3. Describe effective techniques for data visualization and communication
4. Construct effective data visualizations
5. Utilize course concepts and tools for business applications

---

# Where we're going next

1. Develop basic proficiency in `R` programming
2. Understand data structures and manipulation
3. **Describe effective techniques for data visualization and communication**
4. **Construct effective data visualizations**
5. Utilize course concepts and tools for business applications

---

# Schedule overview

#### Weeks 1-5: Programming Foundations

#### Weeks 7-10: Data Visualization Foundations

#### Weeks 11+: Special Topics (mix of programming and dataviz)

See [aem2850.toddgerarden.com/schedule](https://aem2850.toddgerarden.com/schedule/) for details


---
class: inverse, center, middle
name: prologue

# Prologue


---

# [Health and wealth](https://www.youtube.com/watch?v=jbkSRLYSojo)

&lt;img src="img/07/gapminder-screenshot.png" width="75%" style="display: block; margin: auto;" /&gt;

???

Image source: [Gapminder](https://www.gapminder.org/tools/#$chart-type=bubbles)

[Video](https://www.youtube.com/watch?v=jbkSRLYSojo)


---
class: inverse, center, middle
name: grammar-of-graphics

# Data, aesthetics,&lt;br&gt;&amp; the grammar of graphics

---

# Mapping data to aesthetics

.pull-left.center[

&lt;figure&gt;
  &lt;img src="img/07/gg-book.jpg" alt="ZZZ" title="ZZZ" width="55%"&gt;
&lt;/figure&gt;

]

.pull-right[

### Data

A column in a dataset

### Aesthetics

Visual properties of a graph

Position, shape, color, etc.

]

---

# Mapping data to aesthetics

.pull-left[
&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Data&lt;/th&gt;
    &lt;th class="cell-left"&gt;Aesthetic&lt;/th&gt;
    &lt;th class="cell-left"&gt;Geometry&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Wealth&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (x)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Health&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (y)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Continent&lt;/td&gt;
    &lt;td class="cell-left"&gt;Color&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Population&lt;/td&gt;
    &lt;td class="cell-left"&gt;Size&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
]

.pull-right[
&lt;img src="img/07/gapminder-screenshot.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Mapping data to aesthetics using ggplot

.pull-left[
&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Data&lt;/th&gt;
    &lt;th class="cell-left"&gt;Aesthetic&lt;/th&gt;
    &lt;th class="cell-left"&gt;Geometry&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Wealth&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (x)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Health&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (y)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Continent&lt;/td&gt;
    &lt;td class="cell-left"&gt;Color&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Population&lt;/td&gt;
    &lt;td class="cell-left"&gt;Size&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
]

.pull-right[
&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Data&lt;/th&gt;
    &lt;th class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;aes()&lt;/code&gt;&lt;/th&gt;
    &lt;th class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom&lt;/code&gt;&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Wealth&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Health&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Continent&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;color&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Population&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
    &lt;td class="cell-left"&gt;?&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
]

---

# Mapping data to aesthetics using ggplot

.pull-left[
&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Data&lt;/th&gt;
    &lt;th class="cell-left"&gt;Aesthetic&lt;/th&gt;
    &lt;th class="cell-left"&gt;Geometry&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Wealth&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (x)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Health&lt;/td&gt;
    &lt;td class="cell-left"&gt;Position (y)&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Continent&lt;/td&gt;
    &lt;td class="cell-left"&gt;Color&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Population&lt;/td&gt;
    &lt;td class="cell-left"&gt;Size&lt;/td&gt;
    &lt;td class="cell-left"&gt;Point&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
]

.pull-right[
&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Data&lt;/th&gt;
    &lt;th class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;aes()&lt;/code&gt;&lt;/th&gt;
    &lt;th class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom&lt;/code&gt;&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Wealth&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;x&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Health&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Continent&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;color&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;Population&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;size&lt;/code&gt;&amp;emsp;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
]

---

# Barebones `ggplot2::ggplot()` template


```r
library(tidyverse) # tidyverse loads the package ggplot2
```

--

We need to specify data, aesthetic mapping, and geometry:

```r
ggplot(data = DATA,
       mapping = aes(AESTHETIC MAPPINGS)) +
  GEOM_FUNCTION()
```

--

Or, in the context of a data wrangling pipeline:

```r
DATA |&gt; 
  ... |&gt; # intermediate data wrangling (optional)
  ggplot(aes(AESTHETIC MAPPINGS)) +
  GEOM_FUNCTION()
```

---

# Mapping from `gapminder` to aesthetics


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
*_________ |&gt;
  ggplot(aes(x = _________,
             y = _______,
             color = _________,
             size = ___)) +
  geom______() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

Let's fill in the blanks... how do we start?

---

# Mapping from `gapminder` to aesthetics
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder |&gt; 
* ggplot(aes(x = _________,
*            y = _______,
             color = _________,
             size = ___)) +
  geom______() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

Let's fill in the blanks... what should we map to x? y?

---

# Mapping from `gapminder` to aesthetics
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder |&gt; 
  ggplot(aes(x = gdpPercap,
             y = lifeExp,
*            color = _________,
*            size = ___)) +
  geom______() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

Let's fill in the blanks... what should we map to color? size?

---

# Mapping from `gapminder` to aesthetics
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder |&gt; 
  ggplot(aes(x = gdpPercap,
             y = lifeExp,
             color = continent,
             size = pop)) +
* geom______() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

Let's fill in the blanks... what geometry should we use?

---

# Mapping from `gapminder` to aesthetics
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder |&gt; 
  ggplot(aes(x = gdpPercap,
             y = lifeExp,
             color = continent,
             size = pop)) +
  geom_point() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

Let's fill in the blanks... what geometry should we use?

---

# Mapping from `gapminder` to aesthetics
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; gdpPercap &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; lifeExp &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; pop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 974.5803384 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 43.828 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 31889923 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5937.029526 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 76.423 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3600523 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
gapminder |&gt; 
  ggplot(aes(x = gdpPercap,
             y = lifeExp,
             color = continent,
             size = pop)) +
  geom_point() +
  scale_x_log10() + theme_gray(base_size = 20) # ignore this line for now
```

All done! Let's see what we get...

---

# Health and wealth

&lt;img src="07-slides_files/figure-html/show-basic-gapminder-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---
class: inverse, center, middle
name: grammatical-layers

# Grammatical layers

---

# Grammar components as layers

.pull-left[
So far we know about data, aesthetics, and geometries

Think of these components as **layers**

Add them to foundational `ggplot()` with `+`
]

.pull-right[

&amp;nbsp;

![](img/07/ggplot-layers-short@4x.png)
]

???

Layer analogy borrowed from [Thomas Lin Pedersen](https://www.data-imaginist.com/) and his ["Drawing Anything with ggplot2" workshop](https://github.com/thomasp85/ggplot2_workshop).

---

# Possible aesthetics

.pull-left-3.center[

`color` (discrete)

&lt;img src="07-slides_files/figure-html/aes-color-discrete-1.png" width="100%" style="display: block; margin: auto;" /&gt;

`color` (continuous)

&lt;img src="07-slides_files/figure-html/aes-color-continuous-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-middle-3.center[

`size`

&lt;img src="07-slides_files/figure-html/aes-size-1.png" width="100%" style="display: block; margin: auto;" /&gt;

`fill`

&lt;img src="07-slides_files/figure-html/aes-fill-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right-3.center[

`shape`

&lt;img src="07-slides_files/figure-html/aes-shape-1.png" width="100%" style="display: block; margin: auto;" /&gt;

`alpha` (opacity)

&lt;img src="07-slides_files/figure-html/aes-alpha-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Possible geoms

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;&lt;/th&gt;
    &lt;th class="cell-left"&gt;Example geom&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it makes&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;img src="img/07/geom_bar.png"&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_col()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Bar charts&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;img src="img/07/geom_text.png"&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_text()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Text&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;img src="img/07/geom_point.png"&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_point()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Points&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;img src="img/07/geom_boxplot.png"&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_boxplot()&lt;/code&gt;&amp;emsp;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Boxplots&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;img src="img/07/geom_sf.png"&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;geom_sf()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Maps&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Possible geoms

There are dozens of possible geoms

Over the next several weeks we will cover a number of them

See [the **ggplot2** documentation](https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms) for examples of all the different geom layers

---

# Additional layers

.pull-left[
There are many other grammatical layers we can use to describe graphs!

We can sequentially add layers to the foundational `ggplot()` plot to create complex figures

I will give you a quick preview, don't worry about all the details for now
]

.pull-right[
![](img/07/ggplot-layers@4x.png)
]

---

# Scales

Scales change the properties of the variable mapping

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Example layer&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it does&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;scale_x_continuous()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Make the x-axis continuous&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;scale_x_continuous(breaks = 1:5)&amp;ensp;&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Manually specify axis ticks&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;scale_x_log10()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Log the x-axis&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;scale_color_gradient()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Use a gradient&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;scale_fill_viridis_d()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Fill with discrete viridis colors&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Scales

.pull-left[

.center[`scale_x_log10()`]

&lt;img src="07-slides_files/figure-html/scale-example-1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

.center[`scale_color_viridis_d()`]

&lt;img src="07-slides_files/figure-html/scale-example-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Facets

Facets show subplots for different subsets of data

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Example layer&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it does&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;facet_wrap(vars(continent))&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Plot for each continent&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;facet_wrap(vars(continent, year))&lt;/code&gt;&amp;emsp;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Plot for each continent/year&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;facet_wrap(..., ncol = 1)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Put all facets in one column&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;facet_wrap(..., nrow = 1)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Put all facets in one row&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Facets

.pull-left[

.center.small[`facet_wrap(vars(continent))`]

&lt;img src="07-slides_files/figure-html/facet-example-1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

.center.small[`facet_wrap(vars(continent, year))`]

&lt;img src="07-slides_files/figure-html/facet-example-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Coordinates

Change the coordinate system

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Example layer&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it does&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;coord_cartesian(ylim = c(1, 10))&lt;/code&gt;&amp;emsp;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Zoom in where y is 1–10&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;coord_flip()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Switch x and y&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;coord_polar()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Use polar coordinates&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Coordinates

.pull-left[

.center.small[`coord_cartesian(ylim = c(70, 80), xlim = c(10000, 30000))`]

&lt;img src="07-slides_files/figure-html/coord-example-1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

.center.small[`coord_flip()`]

&lt;img src="07-slides_files/figure-html/coord-example-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Labels

Add labels to the plot with a single `labs()` layer

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Example layer&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it does&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;labs(title = "Neat title")&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Title&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;labs(caption = "Something")&lt;/td&gt;
    &lt;td class="cell-left"&gt;Caption&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;labs(y = "Something")&lt;/td&gt;
    &lt;td class="cell-left"&gt;y-axis&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;labs(size = "Population")&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Title of size legend&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Labels

.left-code[

```r
ggplot(gapminder_2007, 
       aes(x = gdpPercap, y = lifeExp, 
           color = continent, size = pop)) +
  geom_point() +
  scale_x_log10() +
  labs(title = "Health and wealth go together",
       subtitle = "Data from 2007",
       x = "Wealth (GDP per capita)",
       y = "Health (life expectancy)",
       color = "Continent",
       size = "Population",
       caption = "Source: The Gapminder Project")
```
]

.right-plot[
![](07-slides_files/figure-html/labels-example-1.png)
]

---

# Theme

`theme()` can be used to change the appearance of anything in a plot

Lots of themes built in and available from other packages

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-left"&gt;Example layer&lt;/th&gt;
    &lt;th class="cell-left"&gt;What it does&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;theme_grey()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Default grey background&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;theme_bw()&lt;/td&gt;
    &lt;td class="cell-left"&gt;Black and white&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;theme_dark()&lt;/td&gt;
    &lt;td class="cell-left"&gt;Dark&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-left"&gt;&lt;code class="remark-inline-code"&gt;theme_minimal()&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Minimal&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

---

# Theme

.pull-left[

.center.small[`theme_dark()`]

&lt;img src="07-slides_files/figure-html/theme-example-1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

.center.small[`theme_minimal()`]

&lt;img src="07-slides_files/figure-html/theme-example-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# Theme

There are collections of pre-built themes online, like [the **ggthemes** package](https://jrnold.github.io/ggthemes/)

.center[
&lt;figure&gt;
  &lt;img src="img/07/ggthemes.png" alt="ggthemes" title="ggthemes" width="55%"&gt;
&lt;/figure&gt;
]

---

# Theme

Organizations often make their own custom themes, like [the BBC](https://bbc.github.io/rcookbook/)

.center[
&lt;figure&gt;
  &lt;img src="img/07/bbc-cookbook.png" alt="ggthemes" title="ggthemes" width="80%"&gt;
&lt;/figure&gt;
]

---

# Theme

Make individual theme adjustments with `theme()`


```r
theme_bw() + 
theme(legend.position = "bottom",
      plot.title = element_text(face = "bold"),
      panel.grid = element_blank(),
      axis.title.y = element_text(face = "italic"))
```

---

# So many possibilities!

.pull-left[
![](img/07/ggplot-layers@4x.png)
]

.pull-right[
These were just a few examples

See [the **ggplot2** documentation](https://ggplot2.tidyverse.org/reference/index.html) for examples of everything you can do
]

---

# A true grammar

.pull-left[
You have probably made graphics in Excel by searching through menus for a specific chart type, and then reshaping your data to work with it

With the grammar of graphics, we don't talk about specific chart **types**
]

.pull-right[
.center[
&lt;figure&gt;
  &lt;img src="img/07/excel-chart-types.png" alt="Excel chart types" title="Excel chart types" width="85%"&gt;
&lt;/figure&gt;
]
]

---

# A true grammar

.pull-left[
With the grammar of graphics, we talk about specific chart **elements**

- .small[Map a column to the x-axis, fill by a variable, `geom_col()` to get stacked bars]

- .small[Geoms can be interchangable (e.g., `geom_violin()` and `geom_boxplot()`)]

This grammar is portable to other software like Tableau, which is [built on the grammar of graphics](https://www.tableau.com/about/blog/2015/4/getting-know-lee-wilkinson-tableaus-new-vp-statistics-38654)
]

.pull-right[
![](img/07/ggplot-layers@4x.png)
]

---

# Describing graphs with the grammar

.left-code[
.box-2.small[Map wealth to the x-axis, health to the y-axis, add points, color by continent, size by population, scale the y-axis with a log, and facet by year]


```r
ggplot(data = filter(gapminder, year %in% c(2002, 2007)), 
       mapping = aes(x = gdpPercap,
                     y = lifeExp,
                     color = continent,
                     size = pop)) +
  geom_point() +
  scale_x_log10() + 
  facet_wrap(vars(year), ncol = 1)
```
]

.right-plot[
![](07-slides_files/figure-html/describe-1-1.png)
]

---

# Describing graphs with the grammar

.left-code[
.box-2.small[Map health to the x-axis, add a histogram with bins for every 5 years, fill and facet by continent]


```r
ggplot(data = gapminder_2007, 
       mapping = aes(x = lifeExp,
                     fill = continent)) +
  geom_histogram(binwidth = 5, 
                 color = "white") +
  guides(fill = "none") +  # Turn off legend
  facet_wrap(vars(continent))
```
]

.right-plot[
![](07-slides_files/figure-html/describe-2-1.png)
]

---

# Describing graphs with the grammar

.left-code[
.box-2.small[Map continent to the x-axis, health to the y-axis, add boxplots, fill by continent]


```r
ggplot(data = gapminder, 
       mapping = aes(x = continent,
                     y = lifeExp,
                     fill = continent)) +
  geom_boxplot() +
  guides(fill = "none")  # Turn off legend
```
]

.right-plot[
![](07-slides_files/figure-html/describe-3-1.png)
]

---

# Describing graphs with the grammar

.left-code[
.box-2.small[Map continent to the x-axis, health to the y-axis, add violin plots, fill by continent]


```r
ggplot(data = gapminder, 
       mapping = aes(x = continent,
                     y = lifeExp,
                     fill = continent)) +
* geom_violin() + # we only had to change this!
  guides(fill = "none")  # Turn off legend
```
]

.right-plot[
![](07-slides_files/figure-html/describe-4-1.png)
]

---
class: inverse, center, middle
name: tidy-data

# Tidy data revisited

---

# Tidy data revisited

`ggplot()` is incredibly flexible

For `ggplot()` to work its magic, your data frame needs to be **tidy**

This requires a bit of upfront work, but it pays off

We never had to modify `gapminder` to make all those different plots!

---

&lt;img src="img/07/tidydata_7.jpg" width="100%" style="display: block; margin: auto;" /&gt;


---
class: inverse, center, middle
name: example-1

# example-07:&lt;br&gt;mapping-data-to-graphics-practice.R


---

# Putting it all together

In the example, we'll build a plot sequentially to see how each grammatical layer changes its appearance

The rest of this section presents that code and output in slide form

For illustrative purposes, let's use data on cars from the data frame `ggplot2::mpg`

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; manufacturer &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; model &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; trans &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; displ &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; hwy &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; drv &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; volkswagen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; gti &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1999 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; manual(m5) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; f &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; volkswagen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; gti &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1999 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; auto(l4) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; f &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

.left-code[
### Start with data and aesthetics


```r
*ggplot(data = mpg,
*      aes(x = displ, # engine displacement
*          y = hwy, # highway mpg
*          color = drv))  # type of drive train
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-1-1.png)
]

---

.left-code[
### Add a point geom


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
* geom_point()
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-2-1.png)
]

---

.left-code[
### Add a smooth geom


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
* geom_smooth()
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-3-1.png)
]

---

.left-code[
### Make it straight


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
* geom_smooth(method = "lm")
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-4-1.png)
]

---

.left-code[
### Use a viridis color scale


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") +
* scale_color_viridis_d()
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-5-1.png)
]

---

.left-code[
### Facet by drive train type


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_color_viridis_d() +
* facet_wrap(vars(drv), ncol = 1)
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-6-1.png)
]

---

.left-code[
### Add labels


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_color_viridis_d() +
  facet_wrap(vars(drv), ncol = 1) +
* labs(x = "Displacement", y = "Highway MPG",
*      color = "Drive",
*      title = "Larger engines use more fuel",
*      subtitle = "Displacement measures engine size")
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-7-1.png)
]

---

.left-code[
### Add a theme


```r
ggplot(data = mpg,
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_color_viridis_d() +
  facet_wrap(vars(drv), ncol = 1) +
  labs(x = "Displacement", y = "Highway MPG",
       color = "Drive",
       title = "Larger engines use more fuel",
       subtitle = "Displacement measures engine size") +
* theme_bw()
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-8-1.png)
]

---

.left-code[
### Modify the theme


```r
ggplot(data = mpg, 
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_color_viridis_d() +
  facet_wrap(vars(drv), ncol = 1) +
  labs(x = "Displacement", y = "Highway MPG",
       color = "Drive",
       title = "Larger engines use more fuel",
       subtitle = "Displacement measures engine size") +
  theme_bw() +
* theme(legend.position = "bottom",
*       plot.title = element_text(face = "bold"))
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-9-1.png)
]

---

.left-code[
### Finished!


```r
ggplot(data = mpg, 
       mapping = aes(x = displ,
                     y = hwy,
                     color = drv)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  scale_color_viridis_d() +
  facet_wrap(vars(drv), ncol = 1) +
  labs(x = "Displacement", y = "Highway MPG",
       color = "Drive",
       title = "Larger engines use more fuel",
       subtitle = "Displacement measures engine size") +
  theme_bw() +
  theme(legend.position = "bottom",
        plot.title = element_text(face = "bold"))
```
]

.right-plot[
![](07-slides_files/figure-html/mpg-layers-finished-1.png)
]

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%",
"ratio": "16:9",
"navigation": {
"scroll": false
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
